<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- <script src="https://aframe.io/releases/1.0.0/aframe.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r79/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/ar.js"></script> -->


    <script src="https://aframe.io/releases/0.6.0/aframe.min.js"></script>
<!-- include ar.js for A-Frame -->
<script src="https://jeromeetienne.github.io/AR.js/aframe/build/aframe-ar.js"></script>
    <title>Document</title>
    <style>
        body {
            margin: 0;
            padding: 0;
        }

        #map {
            display: none;
        }

        #details {
            position: fixed;
            height: 200px;
            background: transparent;
            color: cadetblue;
            padding-left: 20px;
            top:50px;
        }

        #details .title {
            color: slategray;
            font-size: small;
        }

        #locate {
            position: fixed;
            left: 20px;
            top: 10px;
        }

    </style>
</head>
<body>
    <body>
        <div id="map"></div>
        <a-scene embedded arjs="trackingMethod:best;">
           
            <a-marker type='pattern' url='pattern-product_2.patt'>
                 <!-- create your content here. just a box for now -->


                <a-box id="sphere_1" position='-1 1 0' material='color:white'>
                    <a-animation attribute="rotation" dur="10000" fill="forwards" to="0 360 0" repeat="indefinite"></a-animation>
                </a-box>
                <a-box id="sphere" position='1 1 0' material='color:white'>
                    <a-animation attribute="rotation" dur="10000" fill="forwards" to="0 360 0" repeat="indefinite"></a-animation>
                </a-box>
                <!-- define a camera which will move according to the marker position -->
                <!-- <a-marker-camera preset='hiro'></a-marker-camera> -->

            </a-marker>
            <a-marker preset='hiro'>
                <a-box position='-1 2 0' material='color: green;'></a-box>
              </a-marker>

            <a-entity camera></a-entity>
          </a-scene>
     </body>
<script src="https://api.mapbox.com/mapbox-gl-js/v0.42.1/mapbox-gl.js"></script>
<script >
    mapboxgl.accessToken = 'pk.eyJ1Ijoid2l0eXZpcyIsImEiOiJjajl4MGo0OWowczk4MnFtZHVob3I0MTdnIn0.KHhjbfQIuxBcoOsukPTldQ';
var map = new mapboxgl.Map({
    container: 'map',
    style: 'mapbox://styles/mapbox/dark-v9',
    center: [0, 0],
    maxBounds: [[-180, -85], [180, 85]],
    zoom: 1
});

var url = '/findiss';

map.on('load', function () {

    // window.setInterval(function () {
    //     fetch(url).then(function (response) {
    //         return response.json();
    //     })
    //         .then(function (json) {
    //             var data = json,
    //                 issLastSeen = data.features[0].geometry.coordinates,
    //                 details = data.features[0].properties,
    //                 resultingDOM = "",
    //                 resultingText = "";

    //             for (var prop in details) {
    //                 resultingDOM += "<span class='title'>" + prop.toUpperCase() + "</span>" + " " + details[prop] + "</br>";
    //                 resultingText += `${prop.toUpperCase()}  ${details[prop]}`;
    //             }

    //             document.getElementById('details').innerHTML = resultingDOM;
    //             document.getElementById('detailsEntity').setAttribute("text", "value: " + resultingText);
    //             document.getElementById('locate').setAttribute("data-coordinate", JSON.stringify(issLastSeen));

    //             map.getSource('iss').setData(data);
    //         })
    //         .catch(function (error) {
    //             console.log(error);
    //         });

    // }, 2000);

    // map.addSource('iss', { type: 'geojson', data: url });
    // map.addLayer({
    //     "id": "iss",
    //     "type": "symbol",
    //     "source": "iss",
    //     "layout": {
    //         "icon-image": "rocket-15"
    //     }
    // });

    // map.addControl(new mapboxgl.FullscreenControl());

    // document.getElementById('locate').addEventListener('click', function (e) {
    //     var lastSeenLocaton = JSON.parse(this.getAttribute('data-coordinate'));
    //     map.flyTo({
    //         center: lastSeenLocaton
    //     });
    // });

});

map.on('load', function () {
    var canvas = document.querySelector("#map canvas"),
        image = canvas.toDataURL("image/png"),
        sphere = document.getElementById("sphere");

        console.log(canvas)
        // console.log(image)

    sphere.setAttribute("src", "koh.png");
    let sphere_1 = document.getElementById("sphere_1");;
    sphere_1.setAttribute("src", "koh-item.png");

});
</script>
</body>
</html>
